---
- name: Assertions
  assert:
    that:
      - (subpath is not defined) or (subdomain is not defined)
      - (subpath is defined) or (subdomain is defined)
    fail_msg: "Must define exactly one of subdomain and subpath"
- name: Template server block(s)
  template:
    src: subdomain.conf.jinja2
    dest: "{{ (nginx_sites_available, subdomain + '.conf') | path_join }}"
  when: subdomain is defined
- name: Call subpath tasks
  import_tasks: subpath.yml
  when: subpath is defined
